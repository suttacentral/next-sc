<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-icon/iron-icon.html">
<link rel="imoprt" href="../../bower_components/paper-button/paper-button.html">


<!--
  Badge element
-->
<dom-module id="sc-text-carusel">
  <template>
    <style>
        .button {
            @apply --sc-skolar-font-size-s;
            @apply --sc-sans-font;
            width: fit-content;
            margin-top: var(--sc-size-md);
            background-color: var(--sc-primary-accent-color);
            color: var(--sc-tertiary-text-color);
            font-weight: bold;
            text-align: center;        
        }

        .card-button-middle {
            position: absolute;
            transform: translate(-50%);
            bottom: var(--sc-size-md-larger);
        }

        .button-link {
            background: none !important;
        }    

        .chevron {
            display: flex;
            flex-flow: column;
            justify-content: space-around;
            will-change: transform;
            position: absolute;
            top: 50%;
            height: 100%;
            width: var(--sc-size-lg);
            transform: translate(0, -50%);
            --iron-icon-width: var(--sc-size-md-larger);
            --iron-icon-height: var(--sc-size-md-larger);
        }

        .chevron:hover {
            cursor: pointer;
            background-color: var(--sc-disabled-text-color-opaque); 
            --iron-icon-width: calc(var(--sc-size-md-larger) * 1.15);
            --iron-icon-height: calc(var(--sc-size-md-larger) * 1.15);
        }

        .next {
            right: 0;
        }

        .previous {
            left: 0;
        }
    </style>

    <div class="container">
        <div id="previous_button" class="chevron previous" on-tap="_previousItem">
            <iron-icon icon="chevron-left"></iron-icon>                
        </div>
            <div>[[_getItemToShow(selectedItemIndex)]]</div>
            <template is="dom-if" if="link">
                <a class="button-link" href="[[_computeUrl(selectedItemIndex)]]">
                    <paper-button class="button card-button-middle">READ THIS SUTTA</paper-button>
                </a>
            </template>
        <div id="next_button" class="chevron next" on-tap="_nextItem">
            <iron-icon icon="chevron-right"></iron-icon>                
        </div>
    </div>

  </template>

  <script>
      class SCTextCarusel extends Polymer.Element {
          static get is() {
              return 'sc-text-carusel';
          }

          static get properties() {
              return {
                  elements: {
                      type: Array
                  },
                  display: {
                      type: Text
                  },
                  link: {
                      type: Text
                  },
                  selectedItemIndex: {
                      type: Number,
                      value: 0,
                  }
              }
          }

          ready() {
            super.ready();
            setInterval(() => {
                this._nextItem();
            }, 10000);
          }

          _nextItem(e) {
              this.selectedItemIndex = (this.selectedItemIndex + 1) % this.elements.length;
          }

          _previousItem(e) {
              if(this.selectedItemIndex === 0) {
                  this.selectedItemIndex = this.elements.length - 1;
              } else {
                  this.selectedItemIndex = (this.selectedItemIndex - 1) % this.elements.length;
              }
          }

          _getItemToShow(index) {
                let item = this.elements[this.selectedItemIndex];
                if(this.display) {
                    item = item[this.display];
                }
                return item;
          }

          _computeUrl(selectedItemIndex) {
            return `/${this.elements[selectedItemIndex][this.link]}`;
          }
      }

      customElements.define(SCTextCarusel.is, SCTextCarusel);
  </script>
</dom-module>
