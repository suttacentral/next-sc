<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-image/iron-image.html">

<!--
`random-image`
Element to show random image from a given group.

@demo demo/index.html

Used on the homepage in static view.
-->
<dom-module id="random-image">
  <template>
    <style>
      :host {
        display: block;
      }

      .is-circle {
        border: var(--sc-border-color);
        border-radius: 50%;
        box-shadow: 0 5px 10px var(--sc-border-color);
      }

      .image {
        width:640px;
        height:360px;
        z-index:-1;
      }
    </style>

    <iron-image class$="image {{mode}}" sizing="contain" src$="{{imgSrc}}" title="{{imgTitle}}"></iron-image>
  </template>

  <script>
      Polymer({
          is: 'random-image',

          properties: {
              mode: {
                  type: String,
                  notify: true,
                  value: ''
              },
              imgSrc: {
                  type: String
              },
              imgTitle: {
                  type: String
              },
              imagesList: {
                  type: Object,
                  notify: true,
                  // When initializing a property to an object or array value, use a function to ensure that each element
                  // gets its own copy of the value, rather than having an object or array shared across all instances of the element
                  value: function() {
                      return [];
                  }
              }
          },
          _pickRandomProperty: function(obj) {
              let result;
              let count = 0;
              for (let prop in obj)
                  if (Math.random() < 1 / ++count)
                      result = prop;
              return result;
          },
          ready: function() {
              let randomPos = this._pickRandomProperty(this.imagesList);
              this.imgSrc = this.imagesList[randomPos].path;
              this.imgTitle = this.imagesList[randomPos].title;
          }
      });
  </script>
</dom-module>
