<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../../bower_components/iron-meta/iron-meta.html">
<link rel="import" href="../../bower_components/paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../../bower_components/app-localize-behavior/app-localize-behavior.html">

<link rel="import" href="../../elements/addons/text-carousel.html">
<link rel="import" href="../../styles/static-styles.html">

<dom-module id="home-page">
  <template>
    <style include="static-styles">
      .content {
        display: grid;
        grid-auto-flow: row;
        grid-template-columns: 2% 96% 2%;
        grid-row-gap: 80px;
        margin-top: 60px;
      }

      .bottom-space {
        margin-bottom: var(--sc-size-xl) !important;
      }

      .row {
        grid-column-start: 2;
        width: 100%;
      }

      .introduction {
        @apply --sc-skolar-font-size-xl;
        color: var(--sc-primary-text-color);
        text-align: center;
      }

      .text-card {
        width: 100%;
        background-color: var(--sc-secondary-background-color);
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
      }

      .card {
        background-color: var(--sc-secondary-background-color);
        width: 100%;
        min-height: 180px;
        display: flex;
        flex-flow: column;
      }

      .card-heading {
        @apply --sc-skolar-font-size-xxl;
        width: 100%;
        background-color: var(--sc-primary-color-medium);
        color: var(--sc-tertiary-text-color);
        font-weight: bold;
        line-height: 100%;
        text-align: right;
      }

      .card-content {
        position: relative;
        width: 100%;
        background-color: var(--sc-secondary-background-color);
        display: flex;
        align-items: center;
        flex-direction: column;
        justify-content: space-evenly;
        padding-bottom: var(--sc-size-xxl);
      }

      .card-content-text {
        @apply --sc-sans-font;
        @apply --sc-skolar-font-size-md;
        padding: var(--sc-size-lg);
        text-align: center;
      }

      .button-link {
        background: none !important;
      }

      .card-heading-text {
        @apply --sc-sans-font;
        padding: var(--sc-size-lg);
        text-align: center;
        direction: rtl;
      }

      .card-content-video {
        width: 100%;
        padding: 0;
      }

      .d-none {
        display: none;
      }

      .card-text {
        @apply --sc-skolar-font-size-l;
        font-style: italic;
      }

      .button {
        @apply --sc-skolar-font-size-s;
        @apply --sc-sans-font;
        margin-top: var(--sc-size-md);
        background-color: var(--sc-primary-accent-color);
        color: var(--sc-tertiary-text-color);
        font-weight: bold;
        text-align: center;
      }

      .two-paper-cards {
        width: 100%;
      }

      .paper-cards-no-background {
        --paper-card-background-color: var(--sc-primary-background-color);
        box-shadow: none;
      }

      .card-content-wrapper {
        padding: var(--sc-size-md-larger);
      }

      .no-bottom-padding {
        padding-bottom: 0;
      }

      .transparent-card-content-wrapper {
        padding-top: var(--sc-size-md-larger);
      }

      .image-card-text,
      .text-card-text {
        @apply --sc-sans-font;
        margin-top: 1em;
      }

      .card-title-text {
        @apply --paper-font-headline;
        @apply --sc-serif-font;
      }

      .why-we-read {
        text-align: center;
        font-style: italic;
      }

      .first-row {
        grid-column-start: 1;
      }

      .second-row {
        grid-column-start: 2;
      }

      .three-elements-grid {
        display: grid;
        grid-gap: var(--sc-size-lg);
      }

      .full-height {
        height: 100%;
      }

      .embed-container {
        position: relative;
        padding-bottom: 56.25%;
        height: 0;
        overflow: hidden;
        width: 100%;
      }

      .embed-container iframe,
      .embed-container object,
      .embed-container embed {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }

      .paper-card-with-button {
        padding-bottom: calc(var(--sc-size-md-larger) * 2 + 36px);
      }

      paper-card {
        overflow: hidden;
        background-color: var(--sc-secondary-background-color);
        width: 100%;
      }

      .transparent-card {
        background-color: var(--sc-primary-background-color);
      }

      .cards {
        display: grid;
        justify-content: space-between;
        grid-template-columns: 1fr;
        grid-auto-flow: row;
        grid-gap: var(--sc-size-lg);
      }

      .first-card {
        grid-row-start: 1;
      }

      .first-card-button {
        grid-row-start: 2;
      }

      .second-card {
        grid-row-start: 3;
      }

      .second-card-button {
        grid-row-start: 4;
      }

      .big-card-title {
        @apply --sc-skolar-font-size-static-subtitle;
        margin-bottom: var(--sc-size-md);
      }

      .center-text {
        text-align: center;
      }

      .card-button {
        position: absolute;
        right: var(--sc-size-md-larger);
        bottom: var(--sc-size-md-larger);
        margin-left: 0;
      }

      .grid-button {
        justify-self: end;
      }

      .card-heading-subtext {
        @apply --sc-sans-font;
        @apply --sc-skolar-font-size-md;
        font-weight: normal;
        line-height: 1em;
        margin: var(--sc-size-md-larger);
        margin-top: 0;
        text-align: right;
      }

      .spinner {
        --paper-spinner-color: var(--sc-primary-color);
      }

      .card-button-middle {
        position: absolute;
        transform: translate(-50%);
        bottom: var(--sc-size-md-larger);
      }

      .buddhas-words-text {
        @apply --sc-skolar-font-size-xl;
        line-height: 1.1;
      }

      @media (min-width: 960px) {
        .buddhas-words-text {
          @apply --sc-skolar-font-size-static-subtitle;
        }
      }

      @media (min-width: 1280px) {
        .content {
          grid-template-columns: 5% 90% 5%;
        }

        .three-elements-grid {
          grid-template-rows: 1fr 1fr;
          grid-template-columns: 3fr 2fr;
        }

        .three-elements-big {
          grid-column-start: 1;
          grid-row-start: 1;
          grid-row-end: span 2;
        }

        .three-elements-small {
          grid-column-start: 2;
          grid-row-start: unset;
        }

        .three-elements-first-small {
          grid-row-start: 1;
        }

        .three-elements-second-small {
          grid-row-start: 2;
        }

        .cards {
          grid-template-columns: 1fr 1fr;
          grid-gap: var(--sc-size-lg);
        }

        .second-card {
          grid-row-start: 1;
        }

        .first-card-button {
          grid-row-start: 2;
        }

        .second-card-button {
          grid-row-start: 2;
        }

        .card-heading-text {
          text-align: unset;
        }

        .card-button {
          right: unset;
          left: var(--sc-size-md-larger);
        }

        .grid-button {
          justify-self: start;
        }
      }

      @media (min-width: 1600px) {
        .content {
          grid-template-columns: 15% 70% 15%;
        }

        .card {
          flex-flow: unset;
        }

        .card-content-video,
        .card-content {
          width: 75%;
        }

        .card-heading {
          width: 25%;
        }

        .smaller-title {
          @apply --sc-skolar-font-size-dialog-header;
        }

        .d-none {
          display: unset;
        }
      }

      @media (min-width: 1680px) {
        .smaller-title {
          @apply --sc-skolar-font-size-xxl;
        }
      }

    </style>

    <iron-ajax
        auto
        url="[[_computeUrl('epigraphs')]]"
        id="epigraphs-ajax"
        handle-as="json"
        loading="{{ loadingEpigraphs }}"
        last-response="{{ epigraphsData }}"></iron-ajax>

    <iron-ajax
        auto
        url="[[_computeUrl('whyweread')]]"
        id="why-we-read-ajax"
        handle-as="json"
        loading="{{ loadingWhyWeRead }}"
        last-response="{{ whyWeReadData }}"></iron-ajax>

    <iron-meta id="meta"></iron-meta>

    <div id="page-wrap" class="bottom-space">
      <div class="content">

        <div class="row introduction">
          <p>The wisdom of the Buddha has been preserved in a vast ocean of ancient texts.<br class="d-none">
            Many of these scriptures have now been translated into the world’s languages.</p>
          <p>SuttaCentral brings these together and makes them freely available. <br class="d-none">
            Setting aside the boundaries of language and tradition, we let the Buddha speak for himself.</p>
        </div>

        <div class="row">
          <paper-card elevation="2">
            <div class="card">
              <div class="card-heading">
                <div class="card-heading-text">
                  The<br class="d-none">
                  Buddha’s<br class="d-none">
                  words
                </div>
              </div>
              <div class="card-content">
                <div class="card-content-text">
                  <template is="dom-if" if="[[loadingEpigraphs]]">
                    <paper-spinner-lite active class="spinner"></paper-spinner-lite>
                  </template>
                  <template is="dom-if" if="[[!loadingEpigraphs]]">
                    <div class="card-text center-text buddhas-words-text">
                      <sc-text-carousel elements="[[epigraphsData]]" display="epigraph" link="uid"></sc-text-carousel>
                    </div>
                  </template>
                </div>
              </div>
            </div>
          </paper-card>
        </div>

        <div class="row cards">
          <paper-card class="two-paper-cards paper-cards-no-background first-card transparent-card"
                      image="../../img/home-page/becomingone-min.jpg" elevation="2">
            <div class="transparent-card-content-wrapper">
              <div class="card-title-text">What’s here</div>
              <div class="image-card-text">
                SuttaCentral contains early Buddhist texts, known as the Tipiṭaka or “Three Baskets”.
                This is a large collection of teachings attributed to the Buddha or his earliest disciples,
                who were teaching in India around 2500 years ago.
                They are regarded as sacred canon in all schools of Buddhism.
              </div>
            </div>
          </paper-card>
          <paper-card class="two-paper-cards paper-cards-no-background second-card transparent-card"
                      image="../../img/home-page/contemplatingthemoon-min.jpg" elevation="2">
            <div class="transparent-card-content-wrapper">
              <div class="card-title-text">Where to begin</div>
              <div class="image-card-text">
                There are thousands of early Buddhist texts, and they’re not organized for easy reading.
                But here’s the good news: you are not alone. We’ve been down this road ourselves,
                and have tried to make it a little easier for you. Here’s some things you can try.
              </div>
            </div>
          </paper-card>
          <a class="button-link first-card-button grid-button" href="/introduction">
            <paper-button class="button" raised>INTRODUCTION</paper-button>
          </a>
          <a class="button-link second-card-button grid-button" href="/start">
            <paper-button class="button" raised>GET STARTED</paper-button>
          </a>
        </div>

        <div class="row">
          <paper-card elevation="2">
            <div class="card">
              <div class="card-heading">
                <div class="card-heading-text smaller-title">
                  Meet<br class="d-none">
                  SuttaCentral
                </div>
                <div class="card-heading-subtext">
                  When I began to experience the peace of meditation, I needed to understand more deeply what I was
                  going through. I found out there were real teachings from the Buddha himself, and felt drawn to them.
                  For over twenty years now,
                </div>
              </div>
              <div class="card-content-video">
                <div class='embed-container'>
                  <iframe src='https://player.vimeo.com/video/125746164?color=ce8400' frameborder='0'
                          webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
                </div>
              </div>
            </div>
          </paper-card>
        </div>

        <div class="row">
          <div class="big-card-title">
            Tipiṭaka—the three baskets
          </div>
          <div class="three-elements-grid">
            <paper-card class="three-elements-big paper-card-with-button" image="../../img/home-page/14.jpg"
                        elevation="2">
              <div class="card-content-wrapper no-bottom-padding">
                <div class="card-title-text">Discourses</div>
                <div class="image-card-text">
                  These are our primary sources for understanding what the Buddha taught.
                  They record the Buddha’s teachings and conversations on specific occasions
                  with a diverse range of people. Discourses are called sutta in Pali, which is
                  spelled sūtra in Sanskrit.
                </div>
              </div>
              <a class="button-link" href="/discourses">
                <paper-button class="button card-button" raised>MORE ...</paper-button>
              </a>
            </paper-card>
            <paper-card class="three-elements-small three-elements-first-small full-height paper-card-with-button"
                        elevation="2">
              <div class="card-content-wrapper no-bottom-padding">
                <div class="card-title-text">
                  Monastic Law
                </div>
                <div class="text-card-text">
                  The texts on Monastic Law (vinaya) detail the lifestyle, rules,
                  and procedures for Buddhist monks and nuns.
                  They provide the guidelines for Buddhist monastics to this day, and in addition,
                  paint a detailed and vivid picture of everyday life in ancient India.
                </div>
              </div>
              <a class="button-link" href="/vinaya">
                <paper-button class="button card-button" raised>MORE ...</paper-button>
              </a>
            </paper-card>
            <paper-card class="three-elements-small three-elements-second-small full-height paper-card-with-button"
                        elevation="2">
              <div class="card-content-wrapper no-bottom-padding">
                <div class="card-title-text">
                  Abhidhamma
                </div>
                <div class="image-card-text">
                  Abhidhamma texts are systematic summaries and analyses of the teachings drawn from the earlier
                  discourses.
                  The Abhidhamma (spelled abhidharma in Sanskrit) is somewhat later than the Discourses and Vinaya.
                </div>
              </div>
              <a class="button-link" href="/abhidhamma">
                <paper-button class="button card-button" raised>MORE ...</paper-button>
              </a>
            </paper-card>
          </div>
        </div>

        <div class="row">
          <paper-card elevation="2">
            <div class="card">
              <div class="card-heading">
                <div class="card-heading-text">
                  Why<br class="d-none">
                  we<br class="d-none">
                  read
                </div>
              </div>
              <div class="card-content">
                <div class="card-content-text">
                  <template is="dom-if" if="[[loadingWhyWeRead]]">
                    <paper-spinner-lite active class="spinner"></paper-spinner-lite>
                  </template>
                  <template is="dom-if" if="[[!loadingWhyWeRead]]">
                    <div class="why-we-read">
                      <sc-text-carousel elements="[[whyWeReadData]]"></sc-text-carousel>
                    </div>
                    <a class="button-link"
                       href="https://discourse.suttacentral.net/t/why-we-read-tell-us-why-you-read-suttas/6747"
                       target="_blank">
                      <paper-button class="button card-button-middle" raised>TELL US WHY YOU READ</paper-button>
                    </a>
                  </template>
                </div>
              </div>
            </div>
          </paper-card>
        </div>

        <div class="row cards">
          <paper-card class="two-paper-cards first-card paper-card-with-button"
                      image="../../img/home-page/noword-min.jpg"
                      elevation="2">
            <div class="card-content-wrapper">
              <div class="card-title-text">SuttaCentral—a new beginning</div>
              <div class="image-card-text">
                We’re proud to share with you the new SuttaCentral.
                The team has been working on it for over two years, and we think it’s something special.
                The new site features an entirely new translation of the four Pali nikāyas,
                prepared specially for SuttaCentral by Bhante Sujato.
                And the whole site has been re-built to be faster, clearer, and more flexible.
              </div>
            </div>
            <a class="button-link" href="/a-new-beginning">
              <paper-button class="button card-button" raised>WHAT’S NEW IN 2018</paper-button>
            </a>
          </paper-card>
          <paper-card class="two-paper-cards second-card paper-card-with-button"
                      image="../../img/home-page/listeningtotherain-min.jpg" elevation="2">
            <div class="card-content-wrapper">
              <div class="card-title-text">Indexes and Terminology</div>
              <div class="image-card-text">
                Like any specialized field, Buddhist studies has it's own terminology and content. It's easy to get lost
                or to miss references, so here we provide indexes of terms in the early texts sorted by subject, name
                and simile, as well a glossary of important terms. These hand-curated lists offer another way to find
                the sutta or passage that you're looking for.
              </div>
            </div>
            <a class="button-link" href="/subjects">
              <paper-button class="button card-button" raised>Indexes</paper-button>
            </a>
          </paper-card>
        </div>
      </div>
    </div>
  </template>

  <script>
      class SCHomePage extends Polymer.mixinBehaviors([Polymer.AppLocalizeBehavior], ReduxMixin(Polymer.Element)) {
          static get is() {
              return 'home-page';
          }

          static get properties() {
              return {
                  language: {
                      type: String,
                      statePath: 'siteLanguage',
                      observer: '_siteLanguageChanged'
                  },
                  loadingEpigraphs: {
                      type: Boolean
                  },
                  epigraphsData: {
                      type: Object
                  },
                  loadingWhyWeRead: {
                      type: Boolean
                  },
                  whyWeReadData: {
                      type: Object
                  }
              }
          }

          _computeUrl(resource) {
              const apiRoot = this.$.meta.byKey('API_ROOT');
              return `${apiRoot}/${resource}`;
          }

          _siteLanguageChanged() {
              this.loadResources(this.resolveUrl(`/localization/elements/home-page/${this.language}.json`));
          }
      }

      customElements.define(SCHomePage.is, SCHomePage);
  </script>
</dom-module>
